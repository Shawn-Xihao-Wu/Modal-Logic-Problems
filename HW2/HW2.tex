\documentclass[12pt]{article}
\title{PHIL 322---Modal Logic \\Homework 2}
\author{Shawn Wu}
\date{October 18, 2022}
%Add your name and the date in the brackets above, and then remove the percentage 
%sign from the beginning of the line. 
%this just makes sure that all the standard math fonts/definitions/modes can be 
%used.
\usepackage{amsfonts, amsmath, amssymb, amsthm, textcomp, derivation}
%using fullpage does what you think it does, forces the full page to be used rather
%than the LaTeX norm, which is a reasonably narrow column.
\usepackage{fullpage}
%Everything up to here was just setting things up. Everything that you will 
%actually see occurs between the \begin{document} and \end{document} tags

%Commands shortcuts:
\newcommand{\B}{\Box}
\newcommand{\D}{\Diamond}
\newcommand{\s}{\vDash}
\newcommand{\ns}{\nvDash}

\renewcommand\qedsymbol{$\blacksquare$}

\begin{document}
\maketitle
%This gives your name, the date, and the rest of the information you might have entered at the top of the file. 
\noindent
\begin{center}
    ------(1)------
\end{center}
Claim 1: if $F \vDash \D p \rightarrow \B p$ where $F = \langle W, R \rangle$, then $R$ of $F$ is partially functional. 
\begin{proof} Proof by contrapositive.\\
    Suppose $R$ is not partially functional, then there exists $w, u, v \in W$ s.t. $(Rwu \land Rwv)$ but $u \neq v$.
    Define a model $M = \langle F, V \rangle$ where $V(p) = \{ u \}$ (and $V$ is arbitary otherwise). 
    Note that $v \notin V(p)$ because $u \neq v$.
    Therefore, we have $M, w \vDash \D p$ because $Rwu$ and $M, u \vDash p$.
    However, $M, w \nvDash \B p$ since $Rwv$ and $M, v \ns p$.\\
    Hence, $M, w \ns \D p \to \B p$, meaning that $M \ns \D p \to \B p$.
    This in turn means that $F \ns \D p \to \B p$.
\end{proof}

\noindent
\begin{center}
    $\ast$~$\ast$~$\ast$
\end{center}
Claim 2: if $F \vDash \D p \leftrightarrow \B p$ where $F = \langle W, R \rangle$, then $R$ is functional. 
\begin{proof} Proof by contrapositive\\
    Suppose $R$ is not functional, then there exists $w \in W$ s.t. $\forall v \exists u (Rwu \iff u \neq v)$.
    Define a model $M = \langle F, V \rangle$ s.t. for any $w_1, w_2 \in W$ where $w_1 \neq w_2$, if we have $Rww_1$ and $Rww_2$, then either $w_1 \notin V(p)$ or $w_2 \notin V(p)$ but not both (and $V$ is arbitary otherwise).\\
    \\
    Thus, suppose $M, w \s \D p$, then there exists $x \in W$ such that $Rwx$ and $M, x \s p$.
    Since $R$ is not functional, then there exists $y$ such that $x \neq y \iff Rwy$.\\
    Note that either we have $x = y$ or $x \neq y$. 
    However, it can't be the case that $x = y$ because $x = y \implies \neg Rwy \implies \neg Rwx$, which would contradict our original assumption.
    Thus, $x \neq y$.\\
    Since $x \neq y$, then we have $Rwy$.
    By our design of $M$, we know the it must be that case that $y \notin V(p)$.
    Hence, $M, y \ns p$. This entails that $M, w \ns \B p$ or $M, w \s \neg \B p$.\\
    \\
    Now, suppose $M, w \s \neg \B p$, then there must exist $x \in W$ such that $Rwx$ but $M,x \s \neg P$.
    Since $R$ is not functional, then there exists $y$ such that $x \neq y \iff Rwy$.\\
    Note again that we have either $x = y$ or $x \neq y$. 
    Similarly, it can't be the case that $x = y$ because $x = y \implies \neg Rwy \implies \neg Rwx$, which contradicts our original assumption.
    Thus, $x \neq y$.\\
    Since $x \neq y$, then we have $Rwy$. By our design of $M$, we know that it must be the case that $y \in V(p)$.
    Hence, $M, y \s p$. This means that $M, w \s \D p$.\\
    \\
    Together we have $M, w \s \D p \leftrightarrow \neg \B p$ or in other words $M, w \ns \D p \leftrightarrow \B p$. 
    This means that $M \ns \D p \leftrightarrow \B p$, which in turn means that $F \ns \D p \leftrightarrow \B p$.
\end{proof}

\noindent
\begin{center}
    $\ast$~$\ast$~$\ast$
\end{center}
Claim 3: if $F \vDash \B \B p \rightarrow \B p$ where $F = \langle W, R \rangle$, then $R$ is weakly dense. 
\begin{proof} Proof by contrapositive.\\
    Suppose $R$ is not weakly dense, then $\exists u \exists v (Ruv \land \forall w(\neg Ruw \lor \neg Rwv))$.
    Define a model $M = \langle F, V \rangle$ where $\forall x \in W,$ $x \in V(p)$ except when $x = v$ (and $V$ is arbitary otherwise).\\
%    First note it's necessary that $u \neq v$. If $u = v$, then would have $Ruv$ and $\neg Ruv \lor \neg Rvv$, which would contradict our original assumption.
    Since we have $Ruv$ but $M, v \ns p$, thus $M, u \ns \B p$.
    However, note that it's necessary that $M, u \s \B \B p$.
    It's because in order to have $M, u \ns \B \B p$, there must exist a $w \in W$ such that $Ruw$ and $Rwv$, i.e., a path of length $2$ from $u$ to $v$.
    However, we instead have that for all $w \in W$, either $\neg Ruw$ or $\neg Rwv$.
    So, it's impossible to have a path of length 2 from $u$ to $v$.\\
    Hence, $M, u \ns \B \B p \to \B p$, meaning that $M \ns \B \B p \to \B p$.
    This means that $F \ns \B \B p \to \B p$.

\end{proof}

\noindent
\begin{center}
    $\ast$~$\ast$~$\ast$
\end{center}
Claim 4: if $F \vDash \B((p \land \B p) \to q) \lor \B((q \land \B q) \to p)$ where $F = \langle W, R \rangle$, then $R$ is weakly connected. 
\begin{proof} Proof by contrapositive.\\
    Suppose $R$ is not weakly connected, then $\exists w \exists u \exists v (Rwu \land Rwv \land \neg Ruv \land u \neq v \land \neg Rvu)$.
    Define a model $M = \langle F, V \rangle$ where
    \begin{enumerate}
        \item $u \in V(p), u \notin V(q)$, and if $\forall x \in W, Rux$, then $x \in V(p)$
        \item $v \in V(q), v \notin V(p)$, and if $\forall y \in W, Rvy$, then $y \in V(q)$
        \item ($V$ is arbitary otherwise)
    \end{enumerate}
    Note that this defintion of $M$ is possible because of the constraint $(\neg Ruv \land u \neq v \land \neg Rvu)$.
    Since we have $u \neq v$, then it's possible that we have $u \in V(p), u \notin V(q), v \in V(q), v \notin V(p)$.
    And since there are no accessibility relation between $u$ and $v$, then it's possible that $Rux \implies x \in V(p)$ and $Rvy \implies y \in V(q)$.\\
    Therefore, we have $M, u \s (p \land \B p) \land \neg q$ and $M, v \s (q \land \B q) \land \neg p$.\\
    Since $Rwu$ and $Rwv$, then we have $M, w \s \D ((p \land \B p) \land \neg q)$ and $M, w \s \D ((q \land \B q) \land \neg p)$.\\
    Equivalently, we have $M, w \s \neg \B ((p \land \B p) \to q)$ and $M, w \s \neg \B ((q \land \B q) \to p)$.\\
    Or, $M, w \s \neg \B ((p \land \B p) \to q) \land \neg \B ((q \land \B q) \to p)$.\\
    Or in other words, $M, w \s \neg(\B ((p \land \B p) \to q) \lor \B ((q \land \B q) \to p))$.\\
    At last, we arrive at $M, w \ns \B ((p \land \B p) \to q) \lor \B ((q \land \B q) \to p)$.\\
    Therefore, $F \ns \B ((p \land \B p) \to q) \lor \B ((q \land \B q) \to p)$.

\end{proof}

\noindent
\begin{center}
    $\ast$~$\ast$~$\ast$
\end{center}
Claim 5: if $F \vDash \D \B p \to \B \D p$ where $F = \langle W, R \rangle$, then $R$ is weakly directed. 
\begin{proof} Proof by contrapositive.\\
    Suppose $R$ is not weakly directed.
    Then $\exists w \exists u \exists v ((Rwu \land Rwv) \land \forall t(\neg Rut \lor \neg Rvt))$.
    Define a model $M  = \langle F, V \rangle$ s.t. for any $x \in W$, if $Rux$, then $x \in V(p)$; for any $y \in W$, if $Rvy$, then $y \notin V(p)$; ($V$ is arbitary otherwise).\\
    Note that such model of $M$ is possible because we won't be in a situation where $Rux$ and $Rvy$ and $x = y$ given the fact that $R$ is not weakly connected.\\
    In this model, we can see that $M, u \s \B p$, which means that $M, w \s \D \B p$ since $Rwu$.
    However, note that $M, v \s \B \neg p$ is also true in our model. 
    This means that $M, w \s \D \B \neg p$, which is also equivalent to $M, w \s \neg \B \D p$.\\
    Therefore, $M, w \s \D \B p$ but $M, w \s \neg \B \D p$.
    This means that $M, w \ns \D \B p \to \B \D p$, which means that $F \ns \D \B p \to \B \D p$.

\end{proof}

\newpage
\noindent
\begin{center}
    ------(2a)------
\end{center}
Claim: if $F$ is serial, then $F \s (\B A \land \B (\neg A \lor B)) \to \D B$.
\begin{proof} Proof by contradiction.
    Suppose $F$ is serial but $F \ns (\B A \land \B (\neg A \lor B)) \to \D B$.\\
    Then there exists a model $M$ based on $F$ and $w \in W$ s.t. $M, w \ns (\B A \land \B (\neg A \lor B)) \to \D B$.
    This means that we have $M, w \s \B A \land \B (\neg A \lor B)$, but at the same time $M, w \ns \D B$.\\
    Since $F$ is also serial, then there exists $v \in W$ s.t. $Rwv$. 
    Also, since $M, w \ns \D B$, we know that $M, v \ns B$.\\
    Note that $M, w \s \B A \land \B (\neg A \lor B)$, meaning that $M, w \s \B A$ and $M, w \s \B (\neg A \lor B)$. 
    Since we have $Rwv$, then $M, v \s A$ and $M, v \s \neg A \lor B$.
    This means that it must the case that $M, v \s B$.\\
    This creats a contradiction that we have both $M,v \s B$ and $M, v \ns B$.
    Hence the orignal statement is true.
\end{proof}

\noindent
\begin{center}
    ------(2b)------
\end{center}
Claim: if $F$ is transitive and relaxive, then $F \s \D \D (A \land B) \to \D B$.
\begin{proof} Proof by contradiction.
    Suppose $F$ is transitive and relaxive, but $F \ns \D \D (A \land B) \to \D B$.\\
    Then there exists a model $M$ based on $F$ and $w \in W$ s.t. $M, w \ns \D \D (A \land B) \to \D B$.
    Or more precisely, $M, w \s \D \D (A \land B)$ but $M, w \ns \D B$.\\
    From $M, w \s \D \D (A \land B)$, we know that there exists $u \in W$ s.t. $Rwu$ and $M, u \s \D (A \land B)$.
    And from $M, u \s \D (A \land B)$, we know that there exists $v \in W$ s.t. $Ruv$ and $M, v \s A \land B$.\\
    Since $F$ is transitive, then $Rwv$. However, we have $M,v \s B$ from $M, v \s A \land B$.
    This means that $M, w \s \D B$.\\
    Therefore, we reach that $M, w \ns \D B$ and $M, w \s \D B$, a contradiction.
    The original statement is true.
\end{proof}

\newpage
\noindent
\begin{center}
    ------(3a)------
\end{center}
\begin{fitch}
    \fa \neg A \to (A \to B)                                        & TAUT \\
    \fa \B (\neg A \to (A \to B))                                   & NEC, 1\\
    \fa \B (\neg A \to (A \to B)) \to (\B \neg A \to \B (A \to B))  & K\\
    \fa \B \neg A \to \B (A \to B)                                  & MP, 2, 3
\end{fitch}

\noindent
\begin{center}
    ------(3b)------
\end{center} 
\begin{fitch}
    \fa \neg A \lor A                                                       & TAUT\\
    \fa \B (\neg A \lor A)                                                  & NEC, 1\\
    \fa \B (\neg A \lor A) \to \D (\neg A \lor A)                           & D\\
    \fa \D (\neg A \lor A)                                                  & MP, 2, 3\\
    \fa \D (\neg A \lor A) \leftrightarrow \neg \B \neg (\neg A \lor A)     & DUAL\\
    \fa (\D (\neg A \lor A) \leftrightarrow \neg \B \neg (\neg A \lor A)) \to (\D (\neg A \lor A) \to \neg \B \neg (\neg A \lor A)) & TAUT\\
    \fa \D (\neg A \lor A) \to \neg \B \neg (\neg A \lor A)                 & MP, 5, 6\\
    \fa \neg \B \neg (\neg A \lor A)                                        & MP, 4, 7\\
    \fa (A \land \neg A) \to \neg (\neg A \lor A)                           & TAUT\\
    \fa \B((A \land \neg A) \to \neg (\neg A \lor A))                       & NEC, 9\\
    \fa \B((A \land \neg A) \to \neg (\neg A \lor A)) \to (\B (A \land \neg A) \to \B (\neg (\neg A \lor A)))   & K\\
    \fa \B (A \land \neg A) \to \B (\neg (\neg A \lor A))                   & MP, 10, 11\\
    \fa (\B (A \land \neg A) \to \B (\neg (\neg A \lor A))) \to (\neg \B (\neg (\neg A \lor A)) \to \neg \B (A \land \neg A))   & TAUT\\
    \fa \neg \B (\neg (\neg A \lor A)) \to \neg \B (A \land \neg A)         & MP, 12, 13\\
    \fa \neg \B (A \land \neg A)                                            & MP, 8, 14\\
\end{fitch}
\\
\\
\\
Note that line $6, 13$ are respectively the subsitution instances of 
$$(p \leftrightarrow q) \to (p \to q),$$
$$(p \to q) \to (\neg q \to \neg p).$$



\newpage
\noindent
\begin{center}
    ------(4)------
\end{center} 
\begin{proof}
    Assume that $\vdash \D A \to B$. Then for some $n \in \mathbb{N}$,\\
    \\
    \begin{fitch}
        \ftag{\vdots}{\fa \vdots} \\
        \ftag{$n$}{\fa \D A \to B}\\
        \ftag{$n+1$}{\fa \B (\D A \to B)}                                               & NEC, $n$\\
        \ftag{$n+2$}{\fa \B (\D A \to B) \to (\B \D A \to \B B)}                        & K\\
        \ftag{$n+3$}{\fa \B \D A \to \B B}                                              & MP, $n+1, n+2$\\
        \ftag{$n+4$}{\fa A \to \B \D A}                                                 & B\\
        \ftag{$n+5$}{\fa (A \to \B \D A) \to ((\B \D A \to \B B) \to (A \to \B B))}     & TAUT\\
        \ftag{$n+6$}{\fa (\B \D A \to \B B) \to (A \to \B B)}                           & MP, $n+4, n+5$\\
        \ftag{$n+7$}{\fa A \to \B B}                                                    & MP, $n+3, n+6$\\
    \end{fitch}
    \\
    \\
    \\
    Note that line $n+5$ is a subsitution instance of 
    $$(p \to q) \to ((q \to r) \to (p \to r)).$$
    \\
    Hence, we have $\vdash \D A \to B \implies \vdash A \to \B B$.

\end{proof}


\newpage
\noindent
\begin{center}
    ------(5a)------
\end{center} 
\begin{proof}
    
\end{proof}

\noindent
\begin{center}
    ------(5b)------
\end{center} 
\begin{proof}
    
\end{proof}

\noindent
\begin{center}
    ------(5c)------
\end{center} 
\begin{proof}
    
\end{proof}

\noindent
\begin{center}
    ------(5d)------
\end{center} 
\begin{proof}
    
\end{proof}

\noindent
\begin{center}
    ------(5e)------
\end{center} 
\begin{proof}
    
\end{proof}
\end{document}